name: "Test labels retrieval"
on:
  issues:
    types: [ labeled ]

jobs:
  labels:
    runs-on: ubuntu-latest
    outputs:
      area_label: ${{ steps.step_area_label.outputs.result }}
      urgency_label: ${{ steps.step_urgency_label.outputs.result }}
    steps:
      - name: Get area label
        id: step_area_label
        uses: actions/github-script@v6
        with:
          result-encoding: string
          script: |
            const areaLabel = context.payload.issue.labels.map(l => l.name).find(name => name.startsWith('area::'));
            return areaLabel;
      - name: Get urgency label
        id: step_urgency_label
        uses: actions/github-script@v6
        with:
          result-encoding: string
          script: |
            const urgencyLabel = context.payload.issue.labels.map(l => l.name).find(name => name.startsWith('urgency:'));
            return urgencyLabel;
      - name: show event label
        run: echo "event label - ${{github.event.label.name}}"
  assign-engineer:
    needs: labels
    runs-on: ubuntu-latest
    steps:
      - name: show labels
        run: echo "${{needs.labels.outputs.area_label}} ${{needs.labels.outputs.urgency_label}}"
